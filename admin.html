<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Admin Dashboard - BOLA ID UPDATE</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 900px; margin: auto; padding: 20px; }
    h1 { color: #7033b8; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px;}
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left;}
    th { background-color: #033b86; color: white;}
    button { background-color: #7033b8; border: none; padding: 6px 12px; cursor: pointer; border-radius: 4px; color: white; }
    button:hover { background-color: #5a0202; }
    input, textarea { width: 100%; padding: 8px; margin-bottom: 8px; box-sizing: border-box; }
    #loginSection { max-width: 400px; margin: 0 auto 20px; }
    #btnLogout { margin-top: 15px; background: #f44336; color: white; border: none; padding: 8px 12px; cursor: pointer; border-radius: 4px; display:none; }
  </style>
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore-compat.js"></script>
</head>
<body>

  <!-- Bagian Login -->
  <div id="loginSection">
    <h2>Login Admin</h2>
    <input type="text" id="username" placeholder="Username" />
    <input type="password" id="password" placeholder="Password" />
    <button id="btnLogin">Login</button>
    <p id="loginError" style="color:red;"></p>
  </div>

  <h1 id="dashboardTitle" style="display:none;">Admin Dashboard - Kelola Berita</h1>
  <form id="formTambahBerita" style="display:none;">
    <h3>Tambah Berita Baru</h3>
    <input type="text" id="judul" placeholder="Judul" required />
    <input type="date" id="tanggal" required />
    <input type="text" id="gambar" placeholder="URL Gambar (opsional)" />
    <textarea id="isi" placeholder="Isi Berita" required rows="4"></textarea>
    <button type="submit">Tambah Berita</button>
  </form>

  <h3 id="daftarBeritaTitle" style="display:none;">Daftar Berita</h3>
  <table id="tabelBerita" style="display:none;">
    <thead>
      <tr>
        <th>Judul</th>
        <th>Tanggal</th>
        <th>Aksi</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <button id="btnLogout">Logout</button>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCm3bqo01GU4EnYDnUjy7rhzkY3teHMNpY",
      authDomain: "sarjanabola-980e4.firebaseapp.com",
      projectId: "sarjanabola-980e4",
      storageBucket: "sarjanabola-980e4.appspot.com",
      messagingSenderId: "834425792870",
      appId: "1:834425792870:web:e865ba0a526d20f06e40a7",
      measurementId: "G-Q36V68S5NM"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const tabelBody = document.querySelector('#tabelBerita tbody');
    const form = document.getElementById('formTambahBerita');
    const loginSection = document.getElementById('loginSection');
    const btnLogin = document.getElementById('btnLogin');
    const loginError = document.getElementById('loginError');
    const usernameInput = document.getElementById('username');
    const passwordInput = document.getElementById('password');
    const dashboardTitle = document.getElementById('dashboardTitle');
    const daftarBeritaTitle = document.getElementById('daftarBeritaTitle');
    const tabelBerita = document.getElementById('tabelBerita');
    const btnLogout = document.getElementById('btnLogout');

    const validUsername = 'sarjanabola';
    const validPassword = '1234aadd';

    function renderBerita() {
      tabelBody.innerHTML = '';
      db.collection("berita").get().then((querySnapshot) => {
        querySnapshot.forEach((doc) => {
          const berita = doc.data();
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${berita.judul}</td>
            <td>${berita.tanggal}</td>
            <td><button onclick="hapusBerita('${doc.id}')">Hapus</button></td>
          `;
          tabelBody.appendChild(row);
        });
      });
    }

    function hapusBerita(id) {
      if(confirm('Yakin ingin menghapus berita ini?')) {
        db.collection("berita").doc(id).delete().then(() => {
          alert('Berita dihapus.');
          renderBerita();
        });
      }
    }

    form.addEventListener('submit', e => {
      e.preventDefault();
      const judul = document.getElementById('judul').value.trim();
      const tanggal = document.getElementById('tanggal').value;
      const gambar = document.getElementById('gambar').value.trim();
      const isi = document.getElementById('isi').value.trim();

      db.collection("berita").add({ judul, tanggal, gambar, isi })
        .then(() => {
          form.reset();
          alert('Berita berhasil ditambahkan!');
          renderBerita();
        });
    });

    function updateUI() {
      const loggedIn = localStorage.getItem('isLoggedIn') === 'true';
      if (loggedIn) {
        loginSection.style.display = 'none';
        dashboardTitle.style.display = 'block';
        form.style.display = 'block';
        daftarBeritaTitle.style.display = 'block';
        tabelBerita.style.display = 'table';
        btnLogout.style.display = 'inline-block';
        renderBerita();
      } else {
        loginSection.style.display = 'block';
        dashboardTitle.style.display = 'none';
        form.style.display = 'none';
        daftarBeritaTitle.style.display = 'none';
        tabelBerita.style.display = 'none';
        btnLogout.style.display = 'none';
      }
    }

    btnLogin.addEventListener('click', () => {
      const username = usernameInput.value.trim();
      const password = passwordInput.value.trim();
      if(username === validUsername && password === validPassword) {
        localStorage.setItem('isLoggedIn', 'true');
        loginError.textContent = '';
        updateUI();
      } else {
        loginError.textContent = 'Username atau password salah!';
      }
    });

    btnLogout.addEventListener('click', () => {
      localStorage.removeItem('isLoggedIn');
      updateUI();
    });

    window.hapusBerita = hapusBerita;
    updateUI();
  </script>
</body>
</html>
