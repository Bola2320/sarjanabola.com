<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Admin Dashboard - BOLA ID UPDATE</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 900px; margin: auto; padding: 20px; }
    h1 { color: #7033b8; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background-color: #033b86; color: white; }
    button { background-color: #7033b8; border: none; padding: 6px 12px; cursor: pointer; border-radius: 4px; color: white; }
    button:hover { background-color: #5a0202; }
    input, textarea { width: 100%; padding: 8px; margin-bottom: 8px; box-sizing: border-box; }
    #loginSection { max-width: 400px; margin: 0 auto 20px; }
    #btnLogout { margin-top: 15px; background: #f44336; color: white; border: none; padding: 8px 12px; cursor: pointer; border-radius: 4px; display:none; }
  </style>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
</head>
<body>
  <div id="loginSection">
    <h2>Login Admin</h2>
    <input type="email" id="email" placeholder="Email" />
    <input type="password" id="password" placeholder="Password" />
    <button id="btnLogin">Login</button>
    <p id="loginError" style="color:red;"></p>
  </div>

  <h1 id="dashboardTitle" style="display:none;">Admin Dashboard - Kelola Berita & Klasemen</h1>

  <form id="formTambahBerita" style="display:none;">
    <h3 id="formTitle">Tambah Berita Baru</h3>
    <input type="text" id="judul" placeholder="Judul" required />
    <input type="date" id="tanggal" required />
    <input type="text" id="gambar" placeholder="URL Gambar (opsional)" />
    <textarea id="isi" placeholder="Isi Berita" required rows="4"></textarea>
    <button type="submit" id="btnSubmit">Tambah Berita</button>
    <button type="button" id="btnCancelEdit" style="display:none; margin-left: 10px; background: #999;">Batal Edit</button>
  </form>

  <h3 id="daftarBeritaTitle" style="display:none;">Daftar Berita</h3>
  <table id="tabelBerita" style="display:none;">
    <thead>
      <tr>
        <th>Judul</th>
        <th>Tanggal</th>
        <th>Aksi</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <!-- Bagian Tambah Klasemen -->
  <div id="formTambahKlasemen" style="display:none; margin-top: 30px;">
    <h3>Tambah Klasemen</h3>
    <input type="text" id="klub" placeholder="Nama Klub" required />
    <input type="number" id="main" placeholder="Main" required />
    <input type="number" id="menang" placeholder="Menang" required />
    <input type="number" id="seri" placeholder="Seri" required />
    <input type="number" id="kalah" placeholder="Kalah" required />
    <input type="number" id="poin" placeholder="Poin" required />
    <button id="btnTambahKlasemen">Tambah Klasemen</button>
  </div>

  <h3 id="daftarKlasemenTitle" style="display:none; margin-top: 30px;">Daftar Klasemen</h3>
  <table id="tabelKlasemen" style="display:none;">
    <thead>
      <tr>
        <th>Posisi</th>
        <th>Klub</th>
        <th>Main</th>
        <th>Menang</th>
        <th>Seri</th>
        <th>Kalah</th>
        <th>Poin</th>
        <th>Aksi</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <button id="btnLogout">Logout</button>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCm3bqo01GU4EnYDnUjy7rhzkY3teHMNpY",
      authDomain: "sarjanabola-980e4.firebaseapp.com",
      projectId: "sarjanabola-980e4",
      storageBucket: "sarjanabola-980e4.appspot.com",
      messagingSenderId: "834425792870",
      appId: "1:834425792870:web:e865ba0a526d20f06e40a7"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    const loginSection = document.getElementById('loginSection');
    const emailInput = document.getElementById('email');
    const passwordInput = document.getElementById('password');
    const btnLogin = document.getElementById('btnLogin');
    const loginError = document.getElementById('loginError');
    const dashboardTitle = document.getElementById('dashboardTitle');
    const form = document.getElementById('formTambahBerita');
    const formTitle = document.getElementById('formTitle');
    const btnSubmit = document.getElementById('btnSubmit');
    const btnCancelEdit = document.getElementById('btnCancelEdit');
    const judulInput = document.getElementById('judul');
    const tanggalInput = document.getElementById('tanggal');
    const gambarInput = document.getElementById('gambar');
    const isiInput = document.getElementById('isi');
    const daftarBeritaTitle = document.getElementById('daftarBeritaTitle');
    const tabelBerita = document.getElementById('tabelBerita');
    const tabelBody = tabelBerita.querySelector('tbody');
    const btnLogout = document.getElementById('btnLogout');

    const formKlasemen = document.getElementById('formTambahKlasemen');
    const klubInput = document.getElementById('klub');
    const mainInput = document.getElementById('main');
    const menangInput = document.getElementById('menang');
    const seriInput = document.getElementById('seri');
    const kalahInput = document.getElementById('kalah');
    const poinInput = document.getElementById('poin');
    const btnTambahKlasemen = document.getElementById('btnTambahKlasemen');
    const daftarKlasemenTitle = document.getElementById('daftarKlasemenTitle');
    const tabelKlasemen = document.getElementById('tabelKlasemen');
    const klasemenBody = tabelKlasemen.querySelector('tbody');

    let editId = null;

    btnLogin.addEventListener('click', () => {
      const email = emailInput.value.trim();
      const password = passwordInput.value.trim();
      auth.signInWithEmailAndPassword(email, password).then(() => {
        loginSection.style.display = 'none';
        dashboardTitle.style.display = 'block';
        form.style.display = 'block';
        daftarBeritaTitle.style.display = 'block';
        tabelBerita.style.display = 'table';
        formKlasemen.style.display = 'block';
        daftarKlasemenTitle.style.display = 'block';
        tabelKlasemen.style.display = 'table';
        btnLogout.style.display = 'inline-block';
        renderBerita();
        renderKlasemen();
      }).catch(err => {
        loginError.textContent = 'Login gagal: ' + err.message;
      });
    });

    btnLogout.addEventListener('click', () => {
      auth.signOut().then(() => location.reload());
    });

    form.addEventListener('submit', e => {
      e.preventDefault();
      const judul = judulInput.value.trim();
      const tanggal = tanggalInput.value;
      const gambar = gambarInput.value.trim();
      const isi = isiInput.value.trim();
      if (!judul || !tanggal || !isi) return alert('Harap isi semua field.');
      if (editId) {
        db.collection("berita").doc(editId).update({ judul, tanggal, gambar, isi }).then(() => {
          alert('Berita diperbarui.');
          form.reset();
          editId = null;
          renderBerita();
        });
      } else {
        db.collection("berita").add({ judul, tanggal, gambar, isi }).then(() => {
          alert('Berita ditambahkan.');
          form.reset();
          renderBerita();
        });
      }
    });

    btnCancelEdit.addEventListener('click', () => {
      editId = null;
      form.reset();
      btnSubmit.textContent = 'Tambah Berita';
      btnCancelEdit.style.display = 'none';
    });

    function renderBerita() {
      tabelBody.innerHTML = '';
      db.collection("berita").orderBy("tanggal", "desc").get().then(snapshot => {
        snapshot.forEach(doc => {
          const d = doc.data();
          const row = document.createElement('tr');
          row.innerHTML = `<td>${d.judul}</td><td>${d.tanggal}</td><td><button onclick="editBerita('${doc.id}')">Edit</button> <button onclick="hapusBerita('${doc.id}')">Hapus</button></td>`;
          tabelBody.appendChild(row);
        });
      });
    }

    window.editBerita = function(id) {
      db.collection("berita").doc(id).get().then(doc => {
        if (doc.exists) {
          const d = doc.data();
          judulInput.value = d.judul;
          tanggalInput.value = d.tanggal;
          gambarInput.value = d.gambar;
          isiInput.value = d.isi;
          editId = id;
          btnSubmit.textContent = 'Update Berita';
          btnCancelEdit.style.display = 'inline-block';
        }
      });
    }

    window.hapusBerita = function(id) {
      if (confirm('Hapus berita ini?')) {
        db.collection("berita").doc(id).delete().then(() => {
          alert('Berita dihapus.');
          renderBerita();
        });
      }
    }

    btnTambahKlasemen.addEventListener('click', () => {
      const klub = klubInput.value.trim();
      const main = parseInt(mainInput.value);
      const menang = parseInt(menangInput.value);
      const seri = parseInt(seriInput.value);
      const kalah = parseInt(kalahInput.value);
      const poin = parseInt(poinInput.value);
      if (!klub || isNaN(main) || isNaN(menang) || isNaN(seri) || isNaN(kalah) || isNaN(poin)) return alert('Semua field wajib diisi!');
      db.collection("klasemen").add({ klub, main, menang, seri, kalah, poin }).then(() => {
        alert('Klasemen ditambahkan!');
        klubInput.value = mainInput.value = menangInput.value = seriInput.value = kalahInput.value = poinInput.value = '';
        renderKlasemen();
      });
    });

    function renderKlasemen() {
      klasemenBody.innerHTML = '';
      db.collection("klasemen").orderBy("poin", "desc").get().then(snapshot => {
        let posisi = 1;
        snapshot.forEach(doc => {
          const d = doc.data();
          const row = document.createElement('tr');
          row.innerHTML = `<td>${posisi++}</td><td>${d.klub}</td><td>${d.main}</td><td>${d.menang}</td><td>${d.seri}</td><td>${d.kalah}</td><td>${d.poin}</td><td><button onclick="hapusKlasemen('${doc.id}')">Hapus</button></td>`;
          klasemenBody.appendChild(row);
        });
      });
    }

    window.hapusKlasemen = function(id) {
      if (confirm('Hapus data klasemen ini?')) {
        db.collection("klasemen").doc(id).delete().then(() => {
          alert('Data klasemen dihapus.');
          renderKlasemen();
        });
      }
    }
  </script>
</body>
</html>
